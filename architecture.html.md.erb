---
title: Healthwatch Architecture
owner: Healthwatch
---

# Architecture

When being used for multi-foundation monitoring, **Healthwatch** and its exporters will commonly be
deployed as follows:

![alt text](images/ControlPlaneArchitecture.png)

## Healthwatch

The **Healthwatch** tile installs three components: Time series database (TSDB), Grafana and MySQL.  MySQL is used only to store the Grafana
settings and does not store any time series data. 

It can be deployed in high availability (HA) mode (3 MySQL nodes and 2 Proxy nodes) or in non-HA mode
(1 MySQL node and 1 Proxy node). Grafana may also be scaled horizontally beyond the default single VM. TSDB can be scaled
vertically but should not be scaled horizontally. An Nginx proxy is deployed in front of TSDB to provide authorization to
and encryption of metrics stored in TSDB.

![alt text](images/Healthwatch.png)

## Healthwatch Exporter for PAS

The **Healthwatch Exporter for PAS** installs up to three VMs.  Each VM processes a metric type from the Firehose, either Timer, Gauge or Counter.
An operator can choose to deploy all three VMs or any subset thereof.  Metrics are then exposed on a secured TSDB
exposition format endpoints.  Theses VMs can be scaled vertically but should not be scaled horizontally.

![alt text](images/HealthwatchExporterforPAS.png)

## Healthwatch for PKS

The **Healthwatch Exporter for PKS** installs a single VM that collects health metrics from the Bosh Director.  It follows a similar path as what was
done in PAS to get health metrics into the Firehose.  Metrics are then exposed on a secured TSDB exposition format endpoint.  This VM can be scaled
vertically but should not be scaled horizontally.

![alt text](images/HealthwatchExporterforPKS.png)
